<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Adnan Wijayarso">
<meta name="dcterms.date" content="2024-02-11">

<title>Drinking Water Service Level and Gross Domestic Product (GDP) per capita in ASEAN Countries: A Comparative Study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#comparing-water-service-level-in-the-regional-level" id="toc-comparing-water-service-level-in-the-regional-level" class="nav-link" data-scroll-target="#comparing-water-service-level-in-the-regional-level">Comparing water service level in the regional level</a></li>
  <li><a href="#comparing-water-service-level-for-each-asean-country" id="toc-comparing-water-service-level-for-each-asean-country" class="nav-link" data-scroll-target="#comparing-water-service-level-for-each-asean-country">Comparing water service level for each ASEAN country</a></li>
  <li><a href="#how-gdp-per-capita-correlates-with-improved-drinking-water-service-level" id="toc-how-gdp-per-capita-correlates-with-improved-drinking-water-service-level" class="nav-link" data-scroll-target="#how-gdp-per-capita-correlates-with-improved-drinking-water-service-level">How GDP per capita correlates with improved drinking water service level</a></li>
  <li><a href="#how-gdp-per-capita-correlates-with-safely-managed-drinking-water-service-level" id="toc-how-gdp-per-capita-correlates-with-safely-managed-drinking-water-service-level" class="nav-link" data-scroll-target="#how-gdp-per-capita-correlates-with-safely-managed-drinking-water-service-level">How GDP per capita correlates with safely managed drinking water service level</a></li>
  </ul></li>
  <li><a href="#further-discussions" id="toc-further-discussions" class="nav-link" data-scroll-target="#further-discussions">Further discussions</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Drinking Water Service Level and Gross Domestic Product (GDP) per capita in ASEAN Countries: A Comparative Study</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Adnan Wijayarso <a href="https://orcid.org/0009-0005-0216-5559" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 11, 2024</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    The current Eastern and South-Eastern Asia region defined by the United Nations (UN) to report the progress towards Sustainable Development Goals (SDGs) target contains two contrasting groups of countries, in terms of income — therefore it is justified to emphasize the study on ASEAN countries as they may need to narrow the gap in drinking water service level compared to higher income countries. The study finds that the ASEAN region ranks 6th of all regions in level of access to improved drinking water service (94.9% of households served) and 3rd of all regions in level of access to safely managed drinking water service (39.8% of households served). Households in Singapore and Malaysia have the highest access to safely managed drinking water service in the ASEAN region, with service level being 99% and 93.9%, respectively. A strong, positive correlation (Spearman’s correlation coefficient ρ = 0.72, p-value = 0.000) exists between ASEAN and other countries’ access level to improved drinking water service and their GDP per capita. An even stronger correlation (Spearman’s correlation coefficient ρ = 0.88, p-value = 0.000) exists between ASEAN and other countries’ access level to safely managed drinking water service and their GDP per capita.
  </div>
</div>

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Clean drinking water is essential for our life, therefore universal access to safe drinking water is a fundamental human right. On September 2000, the United Nations declared the Millenium Development Goals (MDGs) which targeted to halve the proportion of the population without sustainable access to safe drinking water by 2015. The agenda was even made to be more ambitious by the declaration of Sustainable Development Goals (SDGs) in 2016 which targets all countries participating to ensure availability of safely managed drinking water by 2030.</p>
<p>The United Nations (UN) currently reports the progress made towards SDGs target by dividing the world into eight regions, one of them being Eastern and South-Eastern Asia. At a glance, there seems to be a contrast between East Asian countries (which is dominated by higher income countries such as Japan, China, and South Korea) and Southeast Asian/ASEAN countries (which is dominated by middle income countries such as Indonesia, Thailand, and Viet Nam). Achieving the goal obviously requires tremendous resources, therefore it is justified to emphasize the study on ASEAN countries as they may need to narrow the gap in drinking water service level compared to higher income countries.</p>
<p>This data analysis project is created to explore how drinking water service level differs across ASEAN countries and how it correlates with their Gross Domestic Product (GDP) per capita as the most used tool by governments to measure the economic health of a country, in comparison to other SDG regions.</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p>In this study, we’re using two data sets:</p>
<ol type="1">
<li>The WHO/UNICEF Joint Monitoring Programme for <a href="https://washdata.org/data/household#!/">Water Supply, Sanitation, and Hygiene (JMP) Global Database</a></li>
<li>The World Bank and OECD National Accounts data files on <a href="https://data.worldbank.org/indicator/NY.GDP.PCAP.CD?end=2022&amp;locations=4E&amp;start=1960&amp;view=chart">GDP per capita (in current US$) for East Asia &amp; Pacific Region</a></li>
</ol>
<p>This study will analyze:</p>
<ol type="1">
<li>the summary of 2022 JMP drinking water service ladder in the regional level,</li>
<li>the 2022 JMP drinking water service ladder for each country in the ASEAN region,</li>
<li>the relationship between GDP per capita and the levels of access to improved water service,</li>
<li>and the relationship between GDP per capita and the levels of access to safely managed drinking water service.</li>
</ol>
<p>There is currently no separate category that groups ASEAN countries in the JMP Global Database, as the United Nations (UN) only defined a more general “Eastern and South-Eastern Asia” region in its Report and Statistical Annex. Therefore, in order to make these analyses possible, a new regional system is defined in this study so ASEAN countries can be put into one separate “ASEAN” region.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing datasets</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>WLD_data_raw <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/raw/JMP_2023_WLD_.xlsx"</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>GDPpercap_raw <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/raw/API_NY.GDP.PCAP.CD_DS2_en_excel_v2_6298460_.xlsx"</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidying JMP datasets</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>WLD_data_noref <span class="ot">&lt;-</span> WLD_data_raw[<span class="dv">3</span><span class="sc">:</span><span class="dv">5361</span>,] <span class="sc">|&gt;</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> <span class="st">"DRINKING WATER"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">43</span>, <span class="at">.before =</span> <span class="st">"DRINKING WATER"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sdg_region =</span> ...<span class="dv">43</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="st">`</span><span class="at">DRINKING WATER</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">year =</span> Year) <span class="sc">|&gt;</span> </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">population_1000 =</span> <span class="st">`</span><span class="at">Population(thousands)</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rural_basic =</span> RURAL...<span class="dv">6</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rural_limited =</span> ...<span class="dv">7</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rural_unimproved =</span> ...<span class="dv">8</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rural_surfacewater =</span> ...<span class="dv">9</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">urban_basic =</span> URBAN...<span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">urban_limited =</span> ...<span class="dv">12</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">urban_unimproved =</span> ...<span class="dv">13</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">urban_surfacewater =</span> ...<span class="dv">14</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">national_basic =</span> TOTAL...<span class="dv">16</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">national_limited =</span> ...<span class="dv">17</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">national_unimproved =</span> ...<span class="dv">18</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">national_surfacewater =</span> ...<span class="dv">19</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rural_safelymanaged =</span> RURAL...<span class="dv">21</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(rural_safelymanaged, <span class="at">.before =</span> rural_basic) <span class="sc">|&gt;</span> </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rural_piped =</span> ...<span class="dv">26</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rural_nonpiped =</span> ...<span class="dv">27</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">urban_safelymanaged =</span> URBAN...<span class="dv">28</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(urban_safelymanaged, <span class="at">.before =</span> urban_basic) <span class="sc">|&gt;</span> </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">urban_piped =</span> ...<span class="dv">33</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">urban_nonpiped =</span> ...<span class="dv">34</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">national_safelymanaged =</span> TOTAL...<span class="dv">35</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(national_safelymanaged, <span class="at">.before =</span> national_basic) <span class="sc">|&gt;</span> </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">national_piped =</span> ...<span class="dv">40</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">national_nonpiped =</span> ...<span class="dv">41</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">10</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">15</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">20</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">22</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">23</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">24</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">25</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">29</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">30</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">31</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">32</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">36</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">37</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">38</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(...<span class="dv">39</span>, <span class="at">.after =</span> ...<span class="dv">46</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Making sure there are no &gt;99 and &lt;1 in rural column</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rural_safelymanaged =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    rural_safelymanaged <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    rural_safelymanaged <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> rural_safelymanaged)) <span class="sc">|&gt;</span> </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rural_basic =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    rural_basic <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    rural_basic <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> rural_basic)) <span class="sc">|&gt;</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rural_unimproved =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    rural_unimproved <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    rural_unimproved <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> rural_unimproved)) <span class="sc">|&gt;</span>  </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rural_surfacewater =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    rural_surfacewater <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    rural_surfacewater <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> rural_surfacewater)) <span class="sc">|&gt;</span>  </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rural_piped =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    rural_piped <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    rural_piped <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> rural_piped)) <span class="sc">|&gt;</span>    </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rural_nonpiped =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    rural_nonpiped <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    rural_nonpiped <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> rural_nonpiped)) <span class="sc">|&gt;</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Making sure there are no &gt;99 and &lt;1 in urban column</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_safelymanaged =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    urban_safelymanaged <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    urban_safelymanaged <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> urban_safelymanaged)) <span class="sc">|&gt;</span> </span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_basic =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    urban_basic <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    urban_basic <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> urban_basic)) <span class="sc">|&gt;</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_unimproved =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    urban_unimproved <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    urban_unimproved <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> urban_unimproved)) <span class="sc">|&gt;</span>  </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_surfacewater =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    urban_surfacewater <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    urban_surfacewater <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> urban_surfacewater)) <span class="sc">|&gt;</span>  </span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_piped =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    urban_piped <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    urban_piped <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> urban_piped)) <span class="sc">|&gt;</span>    </span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_nonpiped =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    urban_nonpiped <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    urban_nonpiped <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> urban_nonpiped)) <span class="sc">|&gt;</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Making sure there are no &gt;99 and &lt;1 in national column</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">national_safelymanaged =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    national_safelymanaged <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    national_safelymanaged <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> national_safelymanaged)) <span class="sc">|&gt;</span> </span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">national_basic =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    national_basic <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    national_basic <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> national_basic)) <span class="sc">|&gt;</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">national_unimproved =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    national_unimproved <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    national_unimproved <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> national_unimproved)) <span class="sc">|&gt;</span>  </span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">national_surfacewater =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    national_surfacewater <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    national_surfacewater <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> national_surfacewater)) <span class="sc">|&gt;</span>  </span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">national_piped =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    national_piped <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>    national_piped <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> national_piped)) <span class="sc">|&gt;</span>    </span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">national_nonpiped =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    national_nonpiped <span class="sc">==</span> <span class="st">"&gt;99"</span> <span class="sc">~</span> <span class="st">"99"</span>,</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>    national_nonpiped <span class="sc">==</span> <span class="st">"&lt;1"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> national_nonpiped))</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>WLD_data_noref <span class="ot">&lt;-</span> WLD_data_noref[,<span class="dv">1</span><span class="sc">:</span><span class="dv">28</span>]</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>WLD_iso3_year <span class="ot">&lt;-</span> WLD_data_noref[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">|&gt;</span> </span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(iso3_year, ISO3, year, <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(iso3_year, <span class="at">.after =</span> <span class="st">"id"</span>)</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>WLD_iso3_year <span class="ot">&lt;-</span> WLD_iso3_year[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>WLD_data <span class="ot">&lt;-</span> WLD_data_noref <span class="sc">|&gt;</span> </span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WLD_iso3_year, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">"iso3_year"</span>, <span class="at">.after =</span> year)</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidying World Bank GDP per capita dataset</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>GDPpercap_varnames <span class="ot">&lt;-</span> <span class="fu">c</span>(GDPpercap_raw[<span class="dv">3</span>,])</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>GDPpercap <span class="ot">&lt;-</span> GDPpercap_raw[<span class="dv">4</span><span class="sc">:</span><span class="dv">269</span>,]</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(GDPpercap) <span class="ot">&lt;-</span> GDPpercap_varnames</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>GDPpercap <span class="ot">&lt;-</span> GDPpercap <span class="sc">|&gt;</span> </span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="st">`</span><span class="at">Country Name</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">iso3 =</span> <span class="st">`</span><span class="at">Country Code</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sdg_region =</span> Region) <span class="sc">|&gt;</span> </span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">levels_income =</span> IncomeGroup) <span class="sc">|&gt;</span> </span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">`</span><span class="at">Indicator Name</span><span class="st">`</span>, <span class="at">.before =</span> country) <span class="sc">|&gt;</span> </span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">`</span><span class="at">Indicator Code</span><span class="st">`</span>, <span class="at">.before =</span> country)</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>GDPpercap_long_noref <span class="ot">&lt;-</span> GDPpercap[,<span class="dv">3</span><span class="sc">:</span><span class="dv">69</span>] <span class="sc">|&gt;</span> </span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">"1960"</span><span class="sc">:</span><span class="st">"2022"</span>,</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"GDPpercap"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(year, <span class="at">.after =</span> iso3) <span class="sc">|&gt;</span> </span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> country)</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>GDP_iso3_year <span class="ot">&lt;-</span> GDPpercap_long_noref[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">|&gt;</span> </span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(iso3_year, iso3, year, <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">"iso3_year"</span>, <span class="at">.after =</span> <span class="st">"id"</span>)</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>GDPpercap_long <span class="ot">&lt;-</span> GDPpercap_long_noref <span class="sc">|&gt;</span> </span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(GDP_iso3_year, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(sdg_region, <span class="at">.before =</span> <span class="st">"country.x"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">"iso3_year"</span>, <span class="at">.after =</span> <span class="st">"year"</span>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>GDPpercap_long <span class="ot">&lt;-</span> GDPpercap_long[,<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>] <span class="sc">|&gt;</span> </span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">"id"</span>, <span class="at">.before =</span> <span class="st">"iso3_year"</span>)</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging JMP and GDP dataset into a new WaterService_vs_GDP object</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_wide <span class="ot">&lt;-</span> WLD_data <span class="sc">|&gt;</span> </span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(GDPpercap_long, <span class="at">by =</span> <span class="st">"iso3_year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(levels_income, <span class="at">.before =</span> <span class="st">"population_1000"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(GDPpercap, <span class="at">.before =</span> <span class="st">"population_1000"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">"iso3_year"</span>, <span class="at">.after =</span> national_nonpiped)</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_wide <span class="ot">&lt;-</span> WaterService_vs_GDP_wide[,<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>] <span class="sc">|&gt;</span> </span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> id.x)</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_long <span class="ot">&lt;-</span> WaterService_vs_GDP_wide <span class="sc">|&gt;</span> </span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Converting the data frame into long-format data</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> rural_safelymanaged<span class="sc">:</span>national_nonpiped,</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"residence_levelservice"</span>,</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"percentage"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> <span class="st">"residence_levelservice"</span>,</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"residence"</span>,<span class="st">"level_service"</span>),</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tidying level of drinking water service</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method_waterservice =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>    level_service <span class="sc">==</span> <span class="st">"piped"</span> <span class="sc">~</span> <span class="st">"piped"</span>,</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>    level_service <span class="sc">==</span> <span class="st">"nonpiped"</span> <span class="sc">~</span> <span class="st">"non-piped"</span>,</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levels_service_new =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>    method_waterservice <span class="sc">==</span> <span class="st">"piped"</span> <span class="sc">~</span> <span class="st">"improved"</span>,</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>    method_waterservice <span class="sc">==</span> <span class="st">"non-piped"</span> <span class="sc">~</span> <span class="st">"improved"</span>,</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> level_service)) <span class="sc">|&gt;</span> </span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levels_service =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    levels_service_new <span class="sc">==</span> <span class="st">"safelymanaged"</span> <span class="sc">~</span> <span class="st">"safely managed"</span>,</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>    levels_service_new <span class="sc">==</span> <span class="st">"surfacewater"</span> <span class="sc">~</span> <span class="st">"surface water"</span>,</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> levels_service_new)) <span class="sc">|&gt;</span> </span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(levels_service, <span class="at">.before =</span> method_waterservice) <span class="sc">|&gt;</span> </span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(percentage, <span class="at">.after =</span> method_waterservice) <span class="sc">|&gt;</span> </span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(level_service, <span class="at">.after =</span> percentage) <span class="sc">|&gt;</span> </span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country_population_1000 =</span> population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Removing non-number values from GDPpercap and percentage variable </span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">as.numeric</span>(percentage)) <span class="sc">|&gt;</span> </span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Counting served population_1000 on national, urban, and rural level</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">served_population_1000 =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>      residence <span class="sc">==</span> <span class="st">"national"</span> <span class="sc">~</span> country_population_1000 <span class="sc">*</span> (percentage<span class="sc">/</span><span class="dv">100</span>),</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>      residence <span class="sc">==</span> <span class="st">"urban"</span> <span class="sc">~</span> country_population_1000 <span class="sc">*</span> (<span class="st">`</span><span class="at">% urban</span><span class="st">`</span><span class="sc">/</span><span class="dv">100</span>) <span class="sc">*</span> (percentage<span class="sc">/</span><span class="dv">100</span>),</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>      residence <span class="sc">==</span> <span class="st">"rural"</span> <span class="sc">~</span> country_population_1000 <span class="sc">*</span> ((<span class="dv">100</span> <span class="sc">-</span> <span class="st">`</span><span class="at">% urban</span><span class="st">`</span>)<span class="sc">/</span><span class="dv">100</span>) <span class="sc">*</span> (percentage<span class="sc">/</span><span class="dv">100</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(served_population_1000, <span class="at">.after =</span> percentage) <span class="sc">|&gt;</span> </span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">served_percentage =</span> percentage)</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_long <span class="ot">&lt;-</span> WaterService_vs_GDP_long[,<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>]</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a><span class="co"># Establishing the level_income and level_service using factor</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>factor_income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"High income"</span>,<span class="st">"Upper middle income"</span>, <span class="st">"Lower middle income"</span>, <span class="st">"Low income"</span>)</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>factor_waterservice <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"safely managed"</span>, <span class="st">"improved"</span>, <span class="st">"basic"</span>, <span class="st">"limited"</span>, <span class="st">"unimproved"</span>, <span class="st">"surface water"</span>)</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_long <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levels_income =</span> <span class="fu">factor</span>(levels_income, <span class="at">levels =</span> factor_income)) <span class="sc">|&gt;</span> </span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levels_service =</span> <span class="fu">factor</span>(levels_service, <span class="at">levels =</span> factor_waterservice)) <span class="sc">|&gt;</span> </span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creating new ASEAN region</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_region =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"VNM"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"THA"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"SGP"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"PHL"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"MMR"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"MYS"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"LAO"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"KHM"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"BRN"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    ISO3 <span class="sc">==</span> <span class="st">"IDN"</span> <span class="sc">~</span> <span class="st">"ASEAN"</span>,</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(new_region, <span class="at">.after =</span> sdg_region) <span class="sc">|&gt;</span> </span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">urban_percentage =</span> <span class="st">`</span><span class="at">% urban</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDPpercap =</span> <span class="fu">as.numeric</span>(GDPpercap))</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping each region so that we can compare the average of each region to ASEAN countries</span></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_refcolumn <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(refcolumn, sdg_region, year, residence, levels_service, method_waterservice, <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(refcolumn, <span class="at">.after =</span> <span class="st">"id"</span>)</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_refcolumn <span class="ot">&lt;-</span> WaterService_vs_GDP_refcolumn[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_regionAVG <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WaterService_vs_GDP_refcolumn, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(refcolumn, <span class="at">.after =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDPpercap =</span> <span class="fu">as.numeric</span>(GDPpercap)) <span class="sc">|&gt;</span> </span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(refcolumn) <span class="sc">|&gt;</span> </span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">GDPpercap =</span> <span class="fu">median</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>            <span class="at">served_population_1000 =</span> <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>            <span class="at">country_population_1000 =</span> <span class="fu">sum</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sdgregion_year_residence_levelsservice_methodservice =</span> refcolumn) <span class="sc">|&gt;</span> </span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> sdgregion_year_residence_levelsservice_methodservice,</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"sdg_region"</span>, <span class="st">"year"</span>, <span class="st">"residence"</span>, <span class="st">"levels_service"</span>, <span class="st">"method_waterservice"</span>),</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year)) <span class="sc">|&gt;</span> </span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> sdg_region) <span class="sc">|&gt;</span> </span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_region =</span> sdg_region) <span class="sc">|&gt;</span> </span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(new_region, <span class="at">.after =</span> sdg_region)</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating urban percentage and joining them to WaterService_vs_GDP_worldAVG object</span></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_region_urbanpercentage <span class="ot">&lt;-</span> WaterService_vs_GDP_regionAVG <span class="sc">|&gt;</span> </span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(residence <span class="sc">==</span> <span class="st">"urban"</span>,</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>         levels_service <span class="sc">==</span> <span class="st">"surface water"</span> <span class="sc">|</span> levels_service <span class="sc">==</span> <span class="st">"unimproved"</span> <span class="sc">|</span> levels_service <span class="sc">==</span> <span class="st">"limited"</span> <span class="sc">|</span> levels_service <span class="sc">==</span> <span class="st">"basic"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sdg_region, year) <span class="sc">|&gt;</span> </span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">urban_population_1000 =</span> <span class="fu">sum</span>(served_population_1000),</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>            <span class="at">country_population_1000 =</span> <span class="fu">max</span>(country_population_1000)) <span class="sc">|&gt;</span> </span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_percentage =</span> urban_population_1000 <span class="sc">/</span> country_population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(urban_percentage, <span class="at">.after =</span> year) <span class="sc">|&gt;</span> </span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(region_year, sdg_region, year, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a><span class="co"># Biar WaterService_vs_GDP_regionAVG bisa dijoin sama WaterService_vs_GDP_region_urbanpercentage</span></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_regionAVG_refcolumn <span class="ot">&lt;-</span> WaterService_vs_GDP_regionAVG[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">|&gt;</span> </span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(region_year, sdg_region, year, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_regionAVG <span class="ot">&lt;-</span> WaterService_vs_GDP_regionAVG <span class="sc">|&gt;</span> </span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WaterService_vs_GDP_regionAVG_refcolumn[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_regionAVG <span class="ot">&lt;-</span> WaterService_vs_GDP_regionAVG <span class="sc">|&gt;</span> </span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WaterService_vs_GDP_region_urbanpercentage[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">by =</span> <span class="st">"region_year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(GDPpercap, <span class="at">.after =</span> year) <span class="sc">|&gt;</span> </span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(country_population_1000, <span class="at">.after =</span> GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(urban_percentage, <span class="at">.after =</span> country_population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">served_percentage =</span> served_population_1000 <span class="sc">/</span> country_population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(served_percentage, <span class="at">.before =</span> served_population_1000)</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_regionAVG <span class="ot">&lt;-</span> WaterService_vs_GDP_regionAVG[,<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Counting world average so that we can compare service level average of the world to ASEAN countries</span></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_refcolumn2 <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(refcolumn, year, residence, levels_service, method_waterservice, <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(refcolumn, <span class="at">.after =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(served_population_1000, <span class="at">.after =</span> refcolumn)</span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_refcolumn2 <span class="ot">&lt;-</span> WaterService_vs_GDP_refcolumn2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_worldAVG <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WaterService_vs_GDP_refcolumn2, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(refcolumn, <span class="at">.after =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDPpercap =</span> <span class="fu">as.numeric</span>(GDPpercap)) <span class="sc">|&gt;</span> </span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(refcolumn) <span class="sc">|&gt;</span></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">served_population_1000 =</span> <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>            <span class="at">country_population_1000 =</span> <span class="fu">sum</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>            <span class="at">GDPpercap =</span> <span class="fu">median</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">year_residence_levelsservice_methodservice =</span> <span class="st">"refcolumn"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">population_1000 =</span> served_population_1000) <span class="sc">|&gt;</span></span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> year_residence_levelsservice_methodservice,</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"residence"</span>, <span class="st">"levels_service"</span>, <span class="st">"method_waterservice"</span>),</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year)) <span class="sc">|&gt;</span> </span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> year) <span class="sc">|&gt;</span> </span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_region =</span> <span class="st">"World average"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(new_region, <span class="at">.before =</span> year)</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating urban percentage and joining them to WaterService_vs_GDP_worldAVG object</span></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_world_urbanpercentage <span class="ot">&lt;-</span> WaterService_vs_GDP_worldAVG <span class="sc">|&gt;</span> </span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(residence <span class="sc">==</span> <span class="st">"urban"</span>,</span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>         levels_service <span class="sc">==</span> <span class="st">"surface water"</span> <span class="sc">|</span> levels_service <span class="sc">==</span> <span class="st">"unimproved"</span> <span class="sc">|</span> levels_service <span class="sc">==</span> <span class="st">"limited"</span> <span class="sc">|</span> levels_service <span class="sc">==</span> <span class="st">"basic"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">urban_population_1000 =</span> <span class="fu">sum</span>(population_1000),</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>            <span class="at">country_population_1000 =</span> <span class="fu">max</span>(country_population_1000)) <span class="sc">|&gt;</span> </span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_percentage =</span> urban_population_1000 <span class="sc">/</span> country_population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(urban_percentage, <span class="at">.after =</span> year)</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_worldAVG <span class="ot">&lt;-</span> WaterService_vs_GDP_worldAVG <span class="sc">|&gt;</span> </span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WaterService_vs_GDP_world_urbanpercentage[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">by =</span> <span class="st">"year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(GDPpercap, <span class="at">.after =</span> <span class="st">"year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(country_population_1000, <span class="at">.after =</span> GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">served_population_1000 =</span> population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(urban_percentage, <span class="at">.after =</span> country_population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">served_percentage =</span> served_population_1000 <span class="sc">/</span> country_population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(served_percentage, <span class="at">.before =</span> served_population_1000)</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a><span class="co"># Binding region average and world average to WaterService_vs_GDP_region_worldAVG object</span></span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_region_worldAVG <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(WaterService_vs_GDP_regionAVG, WaterService_vs_GDP_worldAVG)</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_region_worldAVG <span class="ot">&lt;-</span> WaterService_vs_GDP_region_worldAVG <span class="sc">|&gt;</span> </span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(sdg_region, <span class="at">.after =</span> served_population_1000) <span class="sc">|&gt;</span></span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> new_region) <span class="sc">|&gt;</span></span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">levels_waterservice =</span> levels_service) <span class="sc">|&gt;</span> </span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levels_waterservice =</span> <span class="fu">factor</span>(levels_waterservice, <span class="at">levels =</span> factor_waterservice))</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_region_worldAVG <span class="ot">&lt;-</span> WaterService_vs_GDP_region_worldAVG[,<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating WaterService_vs_GDP_ASEAN object containing the details of each country </span></span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_ASEAN <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(new_region <span class="sc">==</span> <span class="st">"ASEAN"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(sdg_region, <span class="at">.after =</span> served_population_1000) <span class="sc">|&gt;</span></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> new_region) <span class="sc">|&gt;</span> </span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">levels_waterservice =</span> levels_service) <span class="sc">|&gt;</span> </span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">levels_waterservice =</span> <span class="fu">factor</span>(levels_waterservice, <span class="at">levels =</span> factor_waterservice))</span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_ASEAN <span class="ot">&lt;-</span> WaterService_vs_GDP_ASEAN[,<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>]</span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a><span class="co"># Writing WaterService_vs_GDP_region_worldAVG.csv from WaterService_vs_GDP_region_worldAVG object</span></span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(WaterService_vs_GDP_region_worldAVG, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/processed/WaterService_vs_GDP_region_worldAVG.csv"</span>))</span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a><span class="co"># Writing WaterService_vs_GDP_ASEAN.csv from  WaterService_vs_GDP_ASEAN object</span></span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(WaterService_vs_GDP_ASEAN, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/processed/WaterService_vs_GDP_ASEAN.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<section id="comparing-water-service-level-in-the-regional-level" class="level3">
<h3 class="anchored" data-anchor-id="comparing-water-service-level-in-the-regional-level">Comparing water service level in the regional level</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering ASEAN's 2022 data on the national level of drinking water service levels</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing ASEAN urban percentage</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_ASEAN_2022_nationalurban <span class="ot">&lt;-</span> WaterService_vs_GDP_ASEAN <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span> <span class="sc">|</span> residence <span class="sc">==</span> <span class="st">"urban"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>         levels_waterservice <span class="sc">!=</span> <span class="st">"safely managed"</span> <span class="sc">&amp;</span> levels_waterservice <span class="sc">!=</span> <span class="st">"improved"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region, residence, levels_waterservice) <span class="sc">|&gt;</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">served_population_1000 =</span> <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">country_population_1000 =</span> <span class="fu">sum</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region, residence) <span class="sc">|&gt;</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">served_population_1000 =</span> <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">country_population_1000 =</span> <span class="fu">mean</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_percentage =</span> served_population_1000 <span class="sc">/</span> country_population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(urban_percentage, <span class="at">.after =</span> region)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_ASEANAVG_2022 <span class="ot">&lt;-</span> WaterService_vs_GDP_ASEAN <span class="sc">|&gt;</span> </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>         levels_waterservice <span class="sc">!=</span> <span class="st">"safely managed"</span> <span class="sc">&amp;</span> levels_waterservice <span class="sc">!=</span> <span class="st">"improved"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region, year, residence, levels_waterservice) <span class="sc">|&gt;</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">served_population_1000 =</span> <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">country_population_1000 =</span> <span class="fu">sum</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">GDPpercap =</span> <span class="fu">median</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">served_percentage =</span> served_population_1000 <span class="sc">/</span> country_population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WaterService_vs_GDP_ASEAN_2022_nationalurban[<span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_ASEAN_2022_safelymanaged <span class="ot">&lt;-</span> WaterService_vs_GDP_ASEAN <span class="sc">|&gt;</span> </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>         levels_waterservice <span class="sc">==</span> <span class="st">"safely managed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region, year, residence, levels_waterservice) <span class="sc">|&gt;</span> </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">served_population_1000 =</span> <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">country_population_1000 =</span> <span class="fu">sum</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">GDPpercap =</span> <span class="fu">median</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">served_percentage =</span> served_population_1000 <span class="sc">/</span> country_population_1000 <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_ASEANAVG_2022 <span class="ot">&lt;-</span> WaterService_vs_GDP_ASEANAVG_2022 <span class="sc">|&gt;</span> </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(WaterService_vs_GDP_ASEAN_2022_safelymanaged) <span class="sc">|&gt;</span> </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(urban_percentage)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering region and world average data of drinking water service levels</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_region_worldAVG_2022 <span class="ot">&lt;-</span> WaterService_vs_GDP_region_worldAVG <span class="sc">|&gt;</span> </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>         levels_waterservice <span class="sc">!=</span> <span class="st">"improved"</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Data to be plotted</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> WaterService_vs_GDP_region_worldAVG_2022 <span class="sc">|&gt;</span> </span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(WaterService_vs_GDP_ASEANAVG_2022) <span class="sc">|&gt;</span> </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>())</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>plot1_basic <span class="ot">&lt;-</span> plot1 <span class="sc">|&gt;</span> </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(levels_waterservice <span class="sc">==</span> <span class="st">"basic"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>plot1_safelymanaged <span class="ot">&lt;-</span> plot1 <span class="sc">|&gt;</span> </span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(levels_waterservice <span class="sc">==</span> <span class="st">"safely managed"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">safelymanaged_percentage =</span> served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">safelymanaged_population_1000 =</span> served_population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>plot1_basic_minus_safelymanaged <span class="ot">&lt;-</span> plot1_basic <span class="sc">|&gt;</span> </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot1_safelymanaged[,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>], <span class="at">by =</span> <span class="st">"new_id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_percentage =</span> served_percentage <span class="sc">-</span> safelymanaged_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_population_1000 =</span> served_population_1000 <span class="sc">-</span> safelymanaged_population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.after =</span> new_population_1000)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>plot1_basic_minus_safelymanaged <span class="ot">&lt;-</span> plot1_basic_minus_safelymanaged[,<span class="dv">12</span><span class="sc">:</span><span class="dv">16</span>] </span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>plot1_rank <span class="ot">&lt;-</span> plot1_basic_minus_safelymanaged <span class="sc">|&gt;</span> </span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(safelymanaged_percentage)) <span class="sc">|&gt;</span> </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(rank, <span class="at">.after =</span> <span class="st">"region"</span>)</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>plot1_rank <span class="ot">&lt;-</span> plot1_rank[,<span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> plot1 <span class="sc">|&gt;</span> </span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot1_basic_minus_safelymanaged, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>    levels_waterservice <span class="sc">==</span> <span class="st">"basic"</span> <span class="sc">~</span> new_percentage,</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> served_percentage)) <span class="sc">|&gt;</span> </span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">population_1000 =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    levels_waterservice <span class="sc">==</span> <span class="st">"basic"</span> <span class="sc">~</span> new_population_1000,</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> served_population_1000)) <span class="sc">|&gt;</span> </span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(percentage, <span class="at">.after =</span> method_waterservice) <span class="sc">|&gt;</span> </span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(population_1000, <span class="at">.after =</span> percentage)</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> plot1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>] <span class="sc">|&gt;</span> </span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot1_rank, <span class="at">by =</span> <span class="st">"region"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">served_percentage =</span> percentage) <span class="sc">|&gt;</span> </span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">served_population_1000 =</span> population_1000)</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot1,</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, rank, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> served_percentage,</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> levels_waterservice)) <span class="sc">+</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Region"</span>, <span class="at">y =</span> <span class="st">"% of served households"</span>) <span class="sc">+</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(served_percentage, <span class="dv">1</span>)),</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="cn">NULL</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-1-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;1: ASEAN drinking water service level, compared to other SDG regions and world average</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-1">Figure&nbsp;1</a> shows that the drinking water service level in the ASEAN region is slightly better than the world average. Most households in ASEAN region already have access to at least basic drinking water service, and 39.8% of households already have access to safely managed drinking water service. However, there is still large gap in the percentage of households with access to safely managed drinking water service between ASEAN region and Latin America &amp; the Caribbean region.</p>
</section>
<section id="comparing-water-service-level-for-each-asean-country" class="level3">
<h3 class="anchored" data-anchor-id="comparing-water-service-level-for-each-asean-country">Comparing water service level for each ASEAN country</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> WaterService_vs_GDP_ASEAN <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         levels_waterservice <span class="sc">!=</span> <span class="st">"improved"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>())</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plot2_basic <span class="ot">&lt;-</span> plot2 <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(levels_waterservice <span class="sc">==</span> <span class="st">"basic"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plot2_safelymanaged <span class="ot">&lt;-</span> plot2 <span class="sc">|&gt;</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(levels_waterservice <span class="sc">==</span> <span class="st">"safely managed"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">safelymanaged_percentage =</span> served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">safelymanaged_population_1000 =</span> served_population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>plot2_basic_minus_safelymanaged <span class="ot">&lt;-</span> plot2_basic <span class="sc">|&gt;</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot2_safelymanaged[,<span class="dv">13</span><span class="sc">:</span><span class="dv">15</span>], <span class="at">by =</span> <span class="st">"new_id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_percentage =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    safelymanaged_percentage <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> served_percentage <span class="sc">-</span> safelymanaged_percentage,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> served_percentage)) <span class="sc">|&gt;</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_population_1000 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    safelymanaged_population_1000 <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> served_population_1000 <span class="sc">-</span> safelymanaged_population_1000,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> served_population_1000)) <span class="sc">|&gt;</span> </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.after =</span> new_population_1000)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>plot2_basic_minus_safelymanaged <span class="ot">&lt;-</span> plot2_basic_minus_safelymanaged[,<span class="dv">15</span><span class="sc">:</span><span class="dv">19</span>] </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plot2_rank <span class="ot">&lt;-</span> plot2_basic_minus_safelymanaged <span class="sc">|&gt;</span> </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(safelymanaged_percentage)) <span class="sc">|&gt;</span> </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(rank, <span class="at">.after =</span> country)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>plot2_rank <span class="ot">&lt;-</span> plot2_rank[,<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> plot2 <span class="sc">|&gt;</span> </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot2_basic_minus_safelymanaged, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    levels_waterservice <span class="sc">==</span> <span class="st">"basic"</span> <span class="sc">~</span> new_percentage,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> served_percentage)) <span class="sc">|&gt;</span> </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">population_1000 =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    levels_waterservice <span class="sc">==</span> <span class="st">"basic"</span> <span class="sc">~</span> new_population_1000,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> served_population_1000)) <span class="sc">|&gt;</span> </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(percentage, <span class="at">.after =</span> method_waterservice) <span class="sc">|&gt;</span> </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(population_1000, <span class="at">.after =</span> percentage) <span class="sc">|&gt;</span> </span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(safelymanaged_percentage, <span class="at">.after =</span> population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(safelymanaged_population_1000, <span class="at">.after =</span> safelymanaged_percentage)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> plot2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>] <span class="sc">|&gt;</span> </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot2_rank, <span class="at">by =</span> <span class="st">"country"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">served_percentage =</span> percentage) <span class="sc">|&gt;</span> </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">served_population_1000 =</span> population_1000)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot2,</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, rank, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> served_percentage,</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> levels_waterservice)) <span class="sc">+</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"ASEAN country"</span>, <span class="at">y =</span> <span class="st">"% of served households"</span>,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note: The JMP data has no estimation on safely managed drinking water level in Brunei Darussalam and Thailand"</span>) <span class="sc">+</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(served_percentage, <span class="dv">1</span>)),</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="cn">NULL</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-2-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;2: ASEAN countries drinking water service level</figcaption>
</figure>
</div>
</div>
</div>
<p>If we delve deeper and compare all countries in ASEAN region, as pictured in <a href="#fig-2">Figure&nbsp;2</a>, it is shown that Singapore and Malaysia hold the highest percentages of households with access to safely managed drinking water service, with their respective service level being 99% and 93.9%. On the contrary, Lao People’s Democratic Republic and Cambodia have the least access to safely managed drinking water service, with service level being 17.9% and 29.1%, respectively.</p>
<p>We can also highlight from <a href="#fig-2">Figure&nbsp;2</a> that Myanmar and Cambodia have relatively lack of access in improved drinking water service on the national level. In 2022, 11.1% of households in Myanmar and 7.3% of households in Cambodia only use surface water as their daily source of drinking water.</p>
</section>
<section id="how-gdp-per-capita-correlates-with-improved-drinking-water-service-level" class="level3">
<h3 class="anchored" data-anchor-id="how-gdp-per-capita-correlates-with-improved-drinking-water-service-level">How GDP per capita correlates with improved drinking water service level</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_ASEAN_2022_improved <span class="ot">&lt;-</span> WaterService_vs_GDP_ASEAN <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         levels_waterservice <span class="sc">==</span> <span class="st">"basic"</span> <span class="sc">|</span> levels_waterservice <span class="sc">==</span> <span class="st">"limited"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">population_1000 =</span> <span class="fu">mean</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_GDPpercap =</span> <span class="fu">median</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum_served_population_1000 =</span> <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="st">"ASEAN"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">served_percentage =</span> sum_served_population_1000 <span class="sc">/</span> population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">|&gt;</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count_country =</span> <span class="fu">n</span>(),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum_population_1000 =</span> <span class="fu">sum</span>(population_1000),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_GDPpercap =</span> <span class="fu">min</span>(median_GDPpercap),</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_GDPpercap =</span> <span class="fu">max</span>(median_GDPpercap),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_GDPpercap =</span> <span class="fu">median</span>(median_GDPpercap),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_served_percentage =</span> <span class="fu">min</span>(served_percentage),</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_served_percentage =</span> <span class="fu">max</span>(served_percentage),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum_served_population_1000 =</span> <span class="fu">sum</span>(sum_served_population_1000)) <span class="sc">|&gt;</span> </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_served_percentage =</span> sum_served_population_1000 <span class="sc">/</span> sum_population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(median_GDPpercap, <span class="at">.after =</span> min_GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(mean_served_percentage, <span class="at">.after =</span> min_served_percentage)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_region_worldAVG_2022_improved <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>         levels_service <span class="sc">==</span> <span class="st">"basic"</span> <span class="sc">|</span> levels_service <span class="sc">==</span> <span class="st">"limited"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sdg_region, country) <span class="sc">|&gt;</span> </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">population_1000 =</span> <span class="fu">mean</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_GDPpercap =</span> <span class="fu">median</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum_served_population_1000 =</span> <span class="fu">ifelse</span>(</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">all</span>(<span class="fu">is.na</span>(served_population_1000)), <span class="cn">NA</span>, </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>              <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span>   </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">served_percentage =</span> sum_served_population_1000 <span class="sc">/</span> population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sdg_region) <span class="sc">|&gt;</span> </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count_country =</span> <span class="fu">n</span>(),</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum_population_1000 =</span> <span class="fu">sum</span>(population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_GDPpercap =</span> <span class="fu">min</span>(median_GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_GDPpercap =</span> <span class="fu">max</span>(median_GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_GDPpercap =</span> <span class="fu">median</span>(median_GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_served_percentage =</span> <span class="fu">min</span>(served_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_served_percentage =</span> <span class="fu">max</span>(served_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum_served_population_1000 =</span> <span class="fu">sum</span>(sum_served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_served_percentage =</span> sum_served_population_1000 <span class="sc">/</span> sum_population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(median_GDPpercap, <span class="at">.after =</span> min_GDPpercap) <span class="sc">|&gt;</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(mean_served_percentage, <span class="at">.after =</span> min_served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> sdg_region)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_2022AVG_improved <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(WaterService_vs_GDP_ASEAN_2022_improved, WaterService_vs_GDP_region_worldAVG_2022_improved) <span class="sc">|&gt;</span> </span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_served_percentage))</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>WaterService_vs_GDP_2022AVG_improved[,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>] <span class="sc">|&gt;</span> </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Region"</span> <span class="ot">=</span> region) <span class="sc">|&gt;</span> </span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"No. of countries"</span> <span class="ot">=</span> count_country) <span class="sc">|&gt;</span> </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Population (1000)"</span> <span class="ot">=</span> sum_population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Min. GDP per capita"</span> <span class="ot">=</span> min_GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median GDP per capita"</span> <span class="ot">=</span> median_GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Max. GDP per capita"</span> <span class="ot">=</span> max_GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Min. service level"</span> <span class="ot">=</span> min_served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Average service level"</span> <span class="ot">=</span> mean_served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Max. service level"</span> <span class="ot">=</span> max_served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="st">"Population (1000)"</span>,</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>             <span class="at">use_seps =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>             <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span>   </span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_currency</span>(<span class="at">columns =</span> <span class="st">"Min. GDP per capita"</span><span class="sc">:</span><span class="st">"Max. GDP per capita"</span>,</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>               <span class="at">currency =</span> <span class="st">"USD"</span>,</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>               <span class="at">use_seps =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>               <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> <span class="st">"Min. service level"</span><span class="sc">:</span><span class="st">"Max. service level"</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="dv">0</span>,</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>              <span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>              <span class="at">table.font.size =</span> <span class="fu">px</span>(<span class="dv">13</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-1" class="anchored">

<div id="heihuftwww" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#heihuftwww table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#heihuftwww thead, #heihuftwww tbody, #heihuftwww tfoot, #heihuftwww tr, #heihuftwww td, #heihuftwww th {
  border-style: none;
}

#heihuftwww p {
  margin: 0;
  padding: 0;
}

#heihuftwww .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#heihuftwww .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#heihuftwww .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#heihuftwww .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#heihuftwww .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#heihuftwww .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#heihuftwww .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#heihuftwww .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#heihuftwww .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#heihuftwww .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#heihuftwww .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#heihuftwww .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#heihuftwww .gt_spanner_row {
  border-bottom-style: hidden;
}

#heihuftwww .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#heihuftwww .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#heihuftwww .gt_from_md > :first-child {
  margin-top: 0;
}

#heihuftwww .gt_from_md > :last-child {
  margin-bottom: 0;
}

#heihuftwww .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#heihuftwww .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#heihuftwww .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#heihuftwww .gt_row_group_first td {
  border-top-width: 2px;
}

#heihuftwww .gt_row_group_first th {
  border-top-width: 2px;
}

#heihuftwww .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#heihuftwww .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#heihuftwww .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#heihuftwww .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#heihuftwww .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#heihuftwww .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#heihuftwww .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#heihuftwww .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#heihuftwww .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#heihuftwww .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#heihuftwww .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#heihuftwww .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#heihuftwww .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#heihuftwww .gt_left {
  text-align: left;
}

#heihuftwww .gt_center {
  text-align: center;
}

#heihuftwww .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#heihuftwww .gt_font_normal {
  font-weight: normal;
}

#heihuftwww .gt_font_bold {
  font-weight: bold;
}

#heihuftwww .gt_font_italic {
  font-style: italic;
}

#heihuftwww .gt_super {
  font-size: 65%;
}

#heihuftwww .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#heihuftwww .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#heihuftwww .gt_indent_1 {
  text-indent: 5px;
}

#heihuftwww .gt_indent_2 {
  text-indent: 10px;
}

#heihuftwww .gt_indent_3 {
  text-indent: 15px;
}

#heihuftwww .gt_indent_4 {
  text-indent: 20px;
}

#heihuftwww .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;1:  <p>Comparison of all regions’ characteristics, GDP per capita,<br>and %
of households with access to improved drinking water service</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Region">Region</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="No. of countries">No. of countries</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Population (1000)">Population (1000)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Min. GDP per capita">Min. GDP per capita</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Median GDP per capita">Median GDP per capita</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Max. GDP per capita">Max. GDP per capita</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Min. service level">Min. service level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Average service level">Average service level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Max. service level">Max. service level</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Region" class="gt_row gt_left">Australia and New Zealand</td>
<td headers="No. of countries" class="gt_row gt_right">2</td>
<td headers="Population (1000)" class="gt_row gt_right">31,363</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$48,419</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$56,759</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$65,100</td>
<td headers="Min. service level" class="gt_row gt_right">99.0%</td>
<td headers="Average service level" class="gt_row gt_right">99.0%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Europe and Northern America</td>
<td headers="No. of countries" class="gt_row gt_right">52</td>
<td headers="Population (1000)" class="gt_row gt_right">1,118,593</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$4,534</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$29,675</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$240,862</td>
<td headers="Min. service level" class="gt_row gt_right">90.4%</td>
<td headers="Average service level" class="gt_row gt_right">98.1%</td>
<td headers="Max. service level" class="gt_row gt_right">99.9%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Northern Africa and Western Asia</td>
<td headers="No. of countries" class="gt_row gt_right">25</td>
<td headers="Population (1000)" class="gt_row gt_right">553,690</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$650</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$6,867</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$87,661</td>
<td headers="Min. service level" class="gt_row gt_right">89.1%</td>
<td headers="Average service level" class="gt_row gt_right">97.3%</td>
<td headers="Max. service level" class="gt_row gt_right">100.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Eastern and South-Eastern Asia</td>
<td headers="No. of countries" class="gt_row gt_right">18</td>
<td headers="Population (1000)" class="gt_row gt_right">2,344,325</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,149</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$6,910</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$82,808</td>
<td headers="Min. service level" class="gt_row gt_right">82.4%</td>
<td headers="Average service level" class="gt_row gt_right">96.9%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Central and Southern Asia</td>
<td headers="No. of countries" class="gt_row gt_right">14</td>
<td headers="Population (1000)" class="gt_row gt_right">2,084,590</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,054</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$2,550</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$11,781</td>
<td headers="Min. service level" class="gt_row gt_right">83.3%</td>
<td headers="Average service level" class="gt_row gt_right">96.1%</td>
<td headers="Max. service level" class="gt_row gt_right">99.6%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">ASEAN</td>
<td headers="No. of countries" class="gt_row gt_right">10</td>
<td headers="Population (1000)" class="gt_row gt_right">679,784</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,149</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$4,476</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$82,808</td>
<td headers="Min. service level" class="gt_row gt_right">82.4%</td>
<td headers="Average service level" class="gt_row gt_right">94.9%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Latin America and the Caribbean</td>
<td headers="No. of countries" class="gt_row gt_right">50</td>
<td headers="Population (1000)" class="gt_row gt_right">660,269</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,748</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$12,264</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$99,625</td>
<td headers="Min. service level" class="gt_row gt_right">77.1%</td>
<td headers="Average service level" class="gt_row gt_right">89.6%</td>
<td headers="Max. service level" class="gt_row gt_right">100.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Sub-Saharan Africa</td>
<td headers="No. of countries" class="gt_row gt_right">51</td>
<td headers="Population (1000)" class="gt_row gt_right">1,166,766</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$259</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$1,471</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$13,250</td>
<td headers="Min. service level" class="gt_row gt_right">58.0%</td>
<td headers="Average service level" class="gt_row gt_right">78.1%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Oceania</td>
<td headers="No. of countries" class="gt_row gt_right">21</td>
<td headers="Population (1000)" class="gt_row gt_right">13,676</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,702</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$5,222</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$35,745</td>
<td headers="Min. service level" class="gt_row gt_right">52.6%</td>
<td headers="Average service level" class="gt_row gt_right">57.5%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plot3_allcountries <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         levels_service <span class="sc">==</span> <span class="st">"basic"</span> <span class="sc">|</span> levels_service <span class="sc">==</span> <span class="st">"limited"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(new_region, country) <span class="sc">|&gt;</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">population_1000 =</span> <span class="fu">mean</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">GDPpercap =</span> <span class="fu">median</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum_served_population_1000 =</span> <span class="fu">ifelse</span>(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">all</span>(<span class="fu">is.na</span>(served_population_1000)), <span class="cn">NA</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">served_percentage =</span> sum_served_population_1000 <span class="sc">/</span> population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> new_region) <span class="sc">|&gt;</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"ASEAN"</span> <span class="sc">~</span> region,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other regions"</span>))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>plot3_improved_rank <span class="ot">&lt;-</span> plot3_allcountries <span class="sc">|&gt;</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"ASEAN"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(served_percentage)) <span class="sc">|&gt;</span> </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(country, <span class="at">.before =</span> rank)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>plot3_improved_rank <span class="ot">&lt;-</span> plot3_improved_rank[<span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> plot3_allcountries <span class="sc">|&gt;</span> </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot3_improved_rank, <span class="at">by =</span> <span class="st">"country"</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating minimum GDP per capita a country need to provide improved drinking water service for all</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>plot3_minGDP <span class="ot">&lt;-</span> plot3_allcountries <span class="sc">|&gt;</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(served_percentage <span class="sc">==</span> <span class="fl">0.99</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">min_GDPpercap =</span> <span class="fu">min</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(min_GDPpercap)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating Spearman's rank correlation coefficient</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>plot3_cor <span class="ot">&lt;-</span>  <span class="fu">cor.test</span>(plot3<span class="sc">$</span>GDPpercap, plot3<span class="sc">$</span>served_percentage, <span class="at">use =</span> <span class="st">"complete.obs"</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>plot3_conclusion <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(plot3_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="fl">0.9</span> <span class="sc">&amp;</span> plot3_cor<span class="sc">$</span>estimate <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"very strong"</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>            plot3_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="fl">0.7</span> <span class="sc">&amp;</span> plot3_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="fl">0.9</span> <span class="sc">~</span> <span class="st">"strong"</span>,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>            plot3_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> plot3_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="fl">0.7</span> <span class="sc">~</span> <span class="st">"moderate"</span>,</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>            plot3_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> plot3_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="st">"weak"</span>,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>            plot3_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> plot3_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"very weak"</span>))</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>plot3_relation <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(plot3_cor<span class="sc">$</span>estimate <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> plot3_cor<span class="sc">$</span>estimate <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"positive"</span>,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>            plot3_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> plot3_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"negative"</span>))</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>plot3_caption <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Spearman's ρ was used to assess the relationship between GDP per capita and water service level ( ρ = "</span>,</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, plot3_cor<span class="sc">$</span>estimate), <span class="st">", p = "</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, plot3_cor<span class="sc">$</span>p.value), <span class="st">"), showing a"</span>,</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  plot3_conclusion, <span class="st">"and "</span>, plot3_relation, <span class="st">"correlation between the two variables"</span>)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>plot3_minGDP_print <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"US$"</span>, <span class="fu">comma</span>(<span class="fu">min</span>(plot3_minGDP<span class="sc">$</span>min_GDPpercap)))</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot3,</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> GDPpercap,</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> served_percentage,</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> region,</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> region)) <span class="sc">+</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ASEAN"</span> <span class="ot">=</span> <span class="st">"red3"</span>, <span class="st">"Other regions"</span> <span class="ot">=</span> <span class="st">"gray80"</span>)) <span class="sc">+</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ASEAN"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"Other regions"</span> <span class="ot">=</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding extra layers of geom_point so the ASEAN points can be on top of other regions' </span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> plot3 <span class="sc">|&gt;</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"ASEAN"</span>),</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red3"</span>,</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>                          rank <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">~</span> country,</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>                          rank <span class="sc">&gt;=</span> <span class="dv">9</span> <span class="sc">~</span> country,</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span>)),</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">0.025</span>) <span class="sc">+</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"GDP per capita vs % of households with access</span><span class="sc">\n</span><span class="st">to improved drinking water services"</span>) <span class="sc">+</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"GDP per capita"</span>, <span class="at">y =</span> <span class="st">"percentage"</span>,</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">str_wrap</span>(plot3_caption, <span class="at">width =</span> <span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar,</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans =</span> <span class="st">"log10"</span>) <span class="sc">+</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3: GDP per capita vs % of households with access to improved drinking water services</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#tbl-1">Table&nbsp;1</a> shows that the ASEAN region ranks in 6th when it comes to providing access to improved drinking water service, with average water service level of 94.9%. On the regional level, the relationship between GDP per capita and the level of access to improved drinking water service remains unclear. However, if we plot the data on the country level using a scatter plot, as pictured in <a href="#fig-3">Figure&nbsp;3</a>, a strong, positive correlation exists <span class="citation" data-cites="schober2018">(<a href="#ref-schober2018" role="doc-biblioref">Schober, Boer, and Schwarte 2018</a>)</span> between the two variables. It appears that the countries able to provide all households with improved drinking water service have minimum GDP per capita of US$ 5,222.</p>
</section>
<section id="how-gdp-per-capita-correlates-with-safely-managed-drinking-water-service-level" class="level3">
<h3 class="anchored" data-anchor-id="how-gdp-per-capita-correlates-with-safely-managed-drinking-water-service-level">How GDP per capita correlates with safely managed drinking water service level</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>table2_ASEAN_2022_safelymanaged <span class="ot">&lt;-</span> WaterService_vs_GDP_ASEAN <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         levels_waterservice <span class="sc">==</span> <span class="st">"safely managed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count_country =</span> <span class="fu">n</span>(),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">population_1000 =</span> <span class="fu">sum</span>(country_population_1000),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_GDPpercap =</span> <span class="fu">min</span>(GDPpercap),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_GDPpercap =</span> <span class="fu">max</span>(GDPpercap),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_GDPpercap =</span> <span class="fu">median</span>(GDPpercap),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_served_percentage =</span> <span class="fu">min</span>(served_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_served_percentage =</span> <span class="fu">max</span>(served_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">served_population_1000 =</span> <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_served_percentage =</span> served_population_1000 <span class="sc">/</span> population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(median_GDPpercap, <span class="at">.after =</span> min_GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(mean_served_percentage, <span class="at">.after =</span> min_served_percentage)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>table2_region_worldAVG_2022_safelymanaged <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>         levels_service <span class="sc">==</span> <span class="st">"safely managed"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sdg_region) <span class="sc">|&gt;</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count_country =</span> <span class="fu">n</span>(),</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">population_1000 =</span> <span class="fu">sum</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_GDPpercap =</span> <span class="fu">min</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_GDPpercap =</span> <span class="fu">max</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_GDPpercap =</span> <span class="fu">median</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_served_percentage =</span> <span class="fu">min</span>(served_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_served_percentage =</span> <span class="fu">max</span>(served_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">served_population_1000 =</span> <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_served_percentage =</span> served_population_1000 <span class="sc">/</span> population_1000 <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(median_GDPpercap, <span class="at">.after =</span> min_GDPpercap) <span class="sc">|&gt;</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(mean_served_percentage, <span class="at">.after =</span> min_served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> sdg_region)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(table2_ASEAN_2022_safelymanaged, table2_region_worldAVG_2022_safelymanaged) <span class="sc">|&gt;</span> </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_served_percentage))</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>table2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>] <span class="sc">|&gt;</span> </span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Region"</span> <span class="ot">=</span> region) <span class="sc">|&gt;</span> </span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"No. of countries"</span> <span class="ot">=</span> count_country) <span class="sc">|&gt;</span> </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Population (1000)"</span> <span class="ot">=</span> population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Min. GDP per capita"</span> <span class="ot">=</span> min_GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Median GDP per capita"</span> <span class="ot">=</span> median_GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Max. GDP per capita"</span> <span class="ot">=</span> max_GDPpercap) <span class="sc">|&gt;</span> </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Min. service level"</span> <span class="ot">=</span> min_served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Average service level"</span> <span class="ot">=</span> mean_served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Max. service level"</span> <span class="ot">=</span> max_served_percentage) <span class="sc">|&gt;</span> </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="st">"Population (1000)"</span>,</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">use_seps =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span>   </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_currency</span>(<span class="at">columns =</span> <span class="st">"Min. GDP per capita"</span><span class="sc">:</span><span class="st">"Max. GDP per capita"</span>,</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>               <span class="at">currency =</span> <span class="st">"USD"</span>,</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>               <span class="at">use_seps =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>               <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_percent</span>(<span class="at">columns =</span> <span class="st">"Min. service level"</span><span class="sc">:</span><span class="st">"Max. service level"</span>,</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="dv">0</span>,</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">column_labels.font.weight =</span> <span class="st">"bold"</span>,</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>              <span class="at">table.font.size =</span> <span class="fu">px</span>(<span class="dv">13</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-2" class="anchored">

<div id="qhrxigqdcq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qhrxigqdcq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qhrxigqdcq thead, #qhrxigqdcq tbody, #qhrxigqdcq tfoot, #qhrxigqdcq tr, #qhrxigqdcq td, #qhrxigqdcq th {
  border-style: none;
}

#qhrxigqdcq p {
  margin: 0;
  padding: 0;
}

#qhrxigqdcq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qhrxigqdcq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qhrxigqdcq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qhrxigqdcq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qhrxigqdcq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qhrxigqdcq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qhrxigqdcq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qhrxigqdcq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qhrxigqdcq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qhrxigqdcq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qhrxigqdcq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qhrxigqdcq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qhrxigqdcq .gt_spanner_row {
  border-bottom-style: hidden;
}

#qhrxigqdcq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qhrxigqdcq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qhrxigqdcq .gt_from_md > :first-child {
  margin-top: 0;
}

#qhrxigqdcq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qhrxigqdcq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qhrxigqdcq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qhrxigqdcq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qhrxigqdcq .gt_row_group_first td {
  border-top-width: 2px;
}

#qhrxigqdcq .gt_row_group_first th {
  border-top-width: 2px;
}

#qhrxigqdcq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhrxigqdcq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qhrxigqdcq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qhrxigqdcq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qhrxigqdcq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhrxigqdcq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qhrxigqdcq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qhrxigqdcq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qhrxigqdcq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qhrxigqdcq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qhrxigqdcq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhrxigqdcq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qhrxigqdcq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhrxigqdcq .gt_left {
  text-align: left;
}

#qhrxigqdcq .gt_center {
  text-align: center;
}

#qhrxigqdcq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qhrxigqdcq .gt_font_normal {
  font-weight: normal;
}

#qhrxigqdcq .gt_font_bold {
  font-weight: bold;
}

#qhrxigqdcq .gt_font_italic {
  font-style: italic;
}

#qhrxigqdcq .gt_super {
  font-size: 65%;
}

#qhrxigqdcq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qhrxigqdcq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qhrxigqdcq .gt_indent_1 {
  text-indent: 5px;
}

#qhrxigqdcq .gt_indent_2 {
  text-indent: 10px;
}

#qhrxigqdcq .gt_indent_3 {
  text-indent: 15px;
}

#qhrxigqdcq .gt_indent_4 {
  text-indent: 20px;
}

#qhrxigqdcq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;2:  <p>Comparison of all regions’ characteristics, GDP per capita,<br>and %
of households with access to safely managed drinking water service</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Region">Region</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="No. of countries">No. of countries</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Population (1000)">Population (1000)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Min. GDP per capita">Min. GDP per capita</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Median GDP per capita">Median GDP per capita</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Max. GDP per capita">Max. GDP per capita</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Min. service level">Min. service level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Average service level">Average service level</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Max. service level">Max. service level</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Region" class="gt_row gt_left">Europe and Northern America</td>
<td headers="No. of countries" class="gt_row gt_right">52</td>
<td headers="Population (1000)" class="gt_row gt_right">1,118,593</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$4,534</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$29,675</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$240,862</td>
<td headers="Min. service level" class="gt_row gt_right">70.7%</td>
<td headers="Average service level" class="gt_row gt_right">93.3%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Latin America and the Caribbean</td>
<td headers="No. of countries" class="gt_row gt_right">50</td>
<td headers="Population (1000)" class="gt_row gt_right">660,269</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,748</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$12,264</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$99,625</td>
<td headers="Min. service level" class="gt_row gt_right">43.0%</td>
<td headers="Average service level" class="gt_row gt_right">55.3%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">ASEAN</td>
<td headers="No. of countries" class="gt_row gt_right">10</td>
<td headers="Population (1000)" class="gt_row gt_right">679,784</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,149</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$4,476</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$82,808</td>
<td headers="Min. service level" class="gt_row gt_right">17.9%</td>
<td headers="Average service level" class="gt_row gt_right">39.8%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Northern Africa and Western Asia</td>
<td headers="No. of countries" class="gt_row gt_right">25</td>
<td headers="Population (1000)" class="gt_row gt_right">553,690</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$650</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$6,867</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$87,661</td>
<td headers="Min. service level" class="gt_row gt_right">47.7%</td>
<td headers="Average service level" class="gt_row gt_right">26.5%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Eastern and South-Eastern Asia</td>
<td headers="No. of countries" class="gt_row gt_right">18</td>
<td headers="Population (1000)" class="gt_row gt_right">2,344,325</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,149</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$6,910</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$82,808</td>
<td headers="Min. service level" class="gt_row gt_right">17.9%</td>
<td headers="Average service level" class="gt_row gt_right">20.1%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Central and Southern Asia</td>
<td headers="No. of countries" class="gt_row gt_right">14</td>
<td headers="Population (1000)" class="gt_row gt_right">2,084,590</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,054</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$2,550</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$11,781</td>
<td headers="Min. service level" class="gt_row gt_right">16.1%</td>
<td headers="Average service level" class="gt_row gt_right">18.1%</td>
<td headers="Max. service level" class="gt_row gt_right">94.9%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Australia and New Zealand</td>
<td headers="No. of countries" class="gt_row gt_right">2</td>
<td headers="Population (1000)" class="gt_row gt_right">31,363</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$48,419</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$56,759</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$65,100</td>
<td headers="Min. service level" class="gt_row gt_right">99.0%</td>
<td headers="Average service level" class="gt_row gt_right">16.4%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Sub-Saharan Africa</td>
<td headers="No. of countries" class="gt_row gt_right">51</td>
<td headers="Population (1000)" class="gt_row gt_right">1,166,766</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$259</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$1,471</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$13,250</td>
<td headers="Min. service level" class="gt_row gt_right">6.1%</td>
<td headers="Average service level" class="gt_row gt_right">13.9%</td>
<td headers="Max. service level" class="gt_row gt_right">95.8%</td></tr>
    <tr><td headers="Region" class="gt_row gt_left">Oceania</td>
<td headers="No. of countries" class="gt_row gt_right">21</td>
<td headers="Population (1000)" class="gt_row gt_right">13,676</td>
<td headers="Min. GDP per capita" class="gt_row gt_right">$1,702</td>
<td headers="Median GDP per capita" class="gt_row gt_right">$5,222</td>
<td headers="Max. GDP per capita" class="gt_row gt_right">$35,745</td>
<td headers="Min. service level" class="gt_row gt_right">8.7%</td>
<td headers="Average service level" class="gt_row gt_right">9.9%</td>
<td headers="Max. service level" class="gt_row gt_right">99.0%</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plot4_allcountries <span class="ot">&lt;-</span> WaterService_vs_GDP_long <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         residence <span class="sc">==</span> <span class="st">"national"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         levels_service <span class="sc">==</span> <span class="st">"safely managed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(new_region, country) <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">population_1000 =</span> <span class="fu">mean</span>(country_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">GDPpercap =</span> <span class="fu">median</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum_served_population_1000 =</span> <span class="fu">ifelse</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">all</span>(<span class="fu">is.na</span>(served_population_1000)), <span class="cn">NA</span>, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">sum</span>(served_population_1000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">served_percentage =</span> sum_served_population_1000 <span class="sc">/</span> population_1000) <span class="sc">|&gt;</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> new_region) <span class="sc">|&gt;</span> </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    region <span class="sc">==</span> <span class="st">"ASEAN"</span> <span class="sc">~</span> region,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other regions"</span>))</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>plot4_improved_rank <span class="ot">&lt;-</span> plot4_allcountries <span class="sc">|&gt;</span> </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"ASEAN"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(served_percentage)) <span class="sc">|&gt;</span> </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(country, <span class="at">.before =</span> rank)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>plot4_improved_rank <span class="ot">&lt;-</span> plot4_improved_rank[<span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> plot4_allcountries <span class="sc">|&gt;</span> </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(plot4_improved_rank, <span class="at">by =</span> <span class="st">"country"</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating minimum GDP per capita a country need to provide safely drinking water service for all</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>plot4_minGDP <span class="ot">&lt;-</span> plot4_allcountries <span class="sc">|&gt;</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(served_percentage <span class="sc">&gt;=</span> <span class="fl">0.99</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">min_GDPpercap =</span> <span class="fu">min</span>(GDPpercap, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(min_GDPpercap)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>plot4_minGDP_print <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"US$"</span>, <span class="fu">comma</span>(<span class="fu">min</span>(plot4_minGDP<span class="sc">$</span>min_GDPpercap)))</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating Spearman's rank correlation coefficient for plot 4</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>plot4_cor <span class="ot">&lt;-</span>  <span class="fu">cor.test</span>(plot4<span class="sc">$</span>GDPpercap, plot4<span class="sc">$</span>served_percentage, <span class="at">use =</span> <span class="st">"complete.obs"</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>plot4_conclusion <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(plot4_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="fl">0.9</span> <span class="sc">&amp;</span> plot4_cor<span class="sc">$</span>estimate <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"very strong"</span>,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>            plot4_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="fl">0.7</span> <span class="sc">&amp;</span> plot4_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="fl">0.9</span> <span class="sc">~</span> <span class="st">"strong"</span>,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>            plot4_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> plot4_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="fl">0.7</span> <span class="sc">~</span> <span class="st">"moderate"</span>,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>            plot4_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> plot4_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="fl">0.4</span> <span class="sc">~</span> <span class="st">"weak"</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>            plot4_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> plot4_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"very weak"</span>))</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>plot4_relation <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(plot4_cor<span class="sc">$</span>estimate <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> plot4_cor<span class="sc">$</span>estimate <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"positive"</span>,</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>            plot4_cor<span class="sc">$</span>estimate <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> plot4_cor<span class="sc">$</span>estimate <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"negative"</span>))</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>plot4_caption <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Spearman's ρ was used to assess the relationship between GDP per capita and water service level ( ρ = "</span>,</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, plot4_cor<span class="sc">$</span>estimate), <span class="st">", p = "</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, plot4_cor<span class="sc">$</span>p.value), <span class="st">"), showing a"</span>,</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  plot4_conclusion, <span class="st">"and "</span>, plot4_relation, <span class="st">"correlation between the two variables"</span>)</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot4,</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> GDPpercap,</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> served_percentage,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> region,</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> region)) <span class="sc">+</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ASEAN"</span> <span class="ot">=</span> <span class="st">"red3"</span>, <span class="st">"Other regions"</span> <span class="ot">=</span> <span class="st">"gray80"</span>)) <span class="sc">+</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ASEAN"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"Other regions"</span> <span class="ot">=</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding extra layers of geom_point so the ASEAN points can be on top of other regions' </span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> plot4 <span class="sc">|&gt;</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"ASEAN"</span>),</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red3"</span>,</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>                          rank <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">~</span> country,</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>                          rank <span class="sc">&gt;=</span> <span class="dv">9</span> <span class="sc">~</span> country,</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span>)),</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">0.025</span>) <span class="sc">+</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"GDP per capita vs % of households with access to</span><span class="sc">\n</span><span class="st">safely managed drinking water services"</span>) <span class="sc">+</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"GDP per capita"</span>, <span class="at">y =</span> <span class="st">"percentage"</span>,</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">str_wrap</span>(plot4_caption, <span class="at">width =</span> <span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar,</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trans =</span> <span class="st">"log10"</span>) <span class="sc">+</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: GDP per capita vs % of households with access to safely managed drinking water services</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#tbl-2">Table&nbsp;2</a> attempts to take a glimpse on how all regions and countries progress towards the ambitious SDG target 6.1 and target 6.2. By region average, ASEAN countries place 3rd on providing safely managed drinking water service level. <a href="#fig-4">Figure&nbsp;4</a> shows an even stronger correlation between GDP per capita and safely drinking water service level, and it appears the countries able to provide all households with safely drinking water service have minimum GDP per capita of US$ 18,390.</p>
</section>
</section>
<section id="further-discussions" class="level2">
<h2 class="anchored" data-anchor-id="further-discussions">Further discussions</h2>
<p>As it is established that the economic health of a country — represented by GDP per capita for the scope of this study — strongly correlates with drinking water service level, it is pivotal for all countries to maintain a healthy GDP growth to ensure their ability to achieve universal coverage of drinking water. The percentage of GDP allocated to improve drinking water service level may vary depends on the countries’ ambition for the goal, as providing safely managed drinking water services as targeted in the SDGs will be significantly more expensive than providing just the basic access as targeted in the MDGs <span class="citation" data-cites="rozenberg2019">(<a href="#ref-rozenberg2019" role="doc-biblioref">Rozenberg and Fay 2019</a>)</span>. Projections indicate that most countries in the Asia-Pacific region (including ASEAN countries) will need to allocate between 1-2% of GDP on water supply and sanitation infrastructure over the period of 2015-2030 <span class="citation" data-cites="leckiefinancing">(<a href="#ref-leckiefinancing" role="doc-biblioref"><strong>leckiefinancing?</strong></a>)</span> (Leckie et al, 2021). Based on the findings of this study, Myanmar and Cambodia will need to allocate greater share of their GDP to catch up with other countries in the ASEAN region.</p>
<p>Another important thing to note is to maintain the quality of open water sources as it intrinsically links to health and economic production of a country, and thus affects the country’s GDP. Research shows that when rivers in middle income countries become moderately polluted (BOD level between 2-8 mg/L), GDP growth is reduced by 1.76%, and when they become heavily polluted (BOD level &gt;8 mg/L), GDP growth is reduced by 2.5% <span class="citation" data-cites="dilipimpact">(<a href="#ref-dilipimpact" role="doc-biblioref"><strong>dilipimpact?</strong></a>)</span> (Desbureaux et al, 2019).</p>
<p>There are various GDP allocation strategy that countries can implement to achieve universal coverage of drinking water, including but not limited to (a) focusing on investments to extend access to unserved population and (b) focusing on investments on improving access level of the population with only access to unimproved and limited drinking water services. Future analyses should look into how the difference on strategies implemented in each country correlates on drinking water service level in each country.</p>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>From this study, we can conclude that:</p>
<ul>
<li>On the regional level, ASEAN region ranks 6th of all regions in level of access to improved drinking water service, with the service level being 94.9% of its households. To break into more details based on the JMP drinking water ladder:
<ul>
<li>39.8% of ASEAN households already have access to safely managed drinking water service (ranks 3rd of all regions),</li>
<li>54.3% of ASEAN households have access to basic drinking water service,</li>
<li>and 0.8% of households have access to limited drinking water service.</li>
</ul></li>
<li>Households in Singapore and Malaysia have the highest access to safely managed drinking water service in the ASEAN region, with service level being 99% and 93.9%, respectively.</li>
<li>A strong, positive correlation exists between ASEAN and other countries’ access level to improved drinking water service and their GDP per capita.</li>
<li>A positive, yet even stronger correlation exists between ASEAN and other countries’ access level to safely managed drinking water service and their GDP per capita.</li>
</ul>
</section>
<section id="references" class="level2 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-rozenberg2019" class="csl-entry" role="listitem">
Rozenberg, Julie, and Marianne Fay. 2019. <em>Beyond the Gap: How Countries Can Afford the Infrastructure They Need While Protecting the Planet</em>. Washington, DC: World Bank. <a href="https://doi.org/10.1596/978-1-4648-1363-4">https://doi.org/10.1596/978-1-4648-1363-4</a>.
</div>
<div id="ref-schober2018" class="csl-entry" role="listitem">
Schober, Patrick, Christa Boer, and Lothar A. Schwarte. 2018. <span>“Correlation Coefficients: Appropriate Use and Interpretation.”</span> <em>Anesthesia &amp; Analgesia</em> 126 (5): 1763–68. <a href="https://doi.org/10.1213/ane.0000000000002864">https://doi.org/10.1213/ane.0000000000002864</a>.
</div>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{wijayarso2024,
  author = {Wijayarso, Adnan},
  title = {Drinking {Water} {Service} {Level} and {Gross} {Domestic}
    {Product} {(GDP)} Per Capita in {ASEAN} {Countries:} {A}
    {Comparative} {Study}},
  date = {2024-02-11},
  url = {https://www.example.com},
  langid = {en},
  abstract = {The current Eastern and South-Eastern Asia region defined
    by the United Nations (UN) to report the progress towards
    Sustainable Development Goals (SDGs) target contains two contrasting
    groups of countries, in terms of income — therefore it is justified
    to emphasize the study on ASEAN countries as they may need to narrow
    the gap in drinking water service level compared to higher income
    countries. The study finds that the ASEAN region ranks 6th of all
    regions in level of access to improved drinking water service
    (94.9\% of households served) and 3rd of all regions in level of
    access to safely managed drinking water service (39.8\% of
    households served). Households in Singapore and Malaysia have the
    highest access to safely managed drinking water service in the ASEAN
    region, with service level being 99\% and 93.9\%, respectively. A
    strong, positive correlation (Spearman’s correlation coefficient ρ =
    0.72, p-value = 0.000) exists between ASEAN and other countries’
    access level to improved drinking water service and their GDP per
    capita. An even stronger correlation (Spearman’s correlation
    coefficient ρ = 0.88, p-value = 0.000) exists between ASEAN and
    other countries’ access level to safely managed drinking water
    service and their GDP per capita.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-wijayarso2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Wijayarso, Adnan. 2024. <span>“Drinking Water Service Level and Gross
Domestic Product (GDP) Per Capita in ASEAN Countries: A Comparative
Study.”</span> My Blog. February 11, 2024. <a href="https://www.example.com">https://www.example.com</a>.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>